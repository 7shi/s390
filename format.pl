#!/usr/bin/env perl

%opt = (
    "%a1"             => ["%aS"        , "-- S"             ],
    "%a2"             => ["%aT"        , "-- -T"            ],
    "%c1"             => ["%cS"        , "-- S"             ],
    "%c2"             => ["%cT"        , "-- -T"            ],
    "%f1"             => ["%fS"        , "-- S"             ],
    "%f2"             => ["%fT"        , "-- -T"            ],
    "%f3"             => ["%fU"        , "-- -- U"          ],
    "%f5"             => ["%fW"        , "-- -- -- W"       ],
    "%f6"             => ["%fX"        , "-- -- -- -X"      ],
    "%f7"             => ["%fY"        , "-- -- -- -- Y"    ],
    "%r1"             => ["%rS"        , "-- S"             ],
    "%r2"             => ["%rT"        , "-- -T"            ],
    "%r3"             => ["%rU"        , "-- -- U"          ],
    "%r5"             => ["%rW"        , "-- -- -- W"       ],
    "%r6"             => ["%rX"        , "-- -- -- -X"      ],
    "1110(%r1,%r3)"   => ["V(%rS,%rU)" , "-- S- UV VV"      ],
    "1110(%r2,%r3)"   => ["V(%rT,%rU)" , "-- -T UV VV"      ],
    "1110(%r3)"       => ["V(%rU)"     , "-- -- UV VV"      ],
    "1110(19,%r3)"    => ["V(S,%rU)"   , "-- SS UV VV"      ],
    "1110(2,%r3)"     => ["V(S,%rU)"   , "-- S- UV VV"      ],
    "2202(%r7)"       => ["Z(%rY)"     , "-- -- -- -- YZ ZZ"],
    "2202(19,%r7)"    => ["Z(S,%rY)"   , "-- SS -- -- YZ ZZ"],
    "2202(3,%r7)"     => ["Z(T,%rY)"   , "-- -T -- -- YZ ZZ"],
    "492630(%r2,%r3)" => ["YV(%rT,%rU)", "-- -T UV VV YY"   ],
    "492630(%r3)"     => ["YV(%rU)"    , "-- -- UV VV YY"   ],
    "0"               => ["S"          , "-- S"             ],
    "1"               => ["S"          , "-- S"             ],
    "2"               => ["T"          , "-- -T"            ],
    "3"               => ["U"          , "-- -- U"          ],
    "4"               => ["U"          , "-- -- -U"         ],
    "7"               => ["Y"          , "-- -- -- -- Y"    ],
    "8"               => ["Z"          , "-- -- -- -- -Z"   ],
    "18"              => ["S"          , "-- SS"            ],
    "52"              => ["U"          , "-- -- UU"         ],
    "86"              => ["W"          , "-- -- -- WW"      ],
    "120"             => ["Y"          , "-- -- -- -- YY"   ],
    "13398"           => ["U"          , "-- -- UU UU"      ],
    "30874"           => ["Y"          , "-- -- -- -- YY YY"],
    "878082202"       => ["U"          , "-- -- UU UU UU UU"],
    "0x468"           => ["0xT"        , "-- -T TT"         ],
    "0x68ac"          => ["0xU"        , "-- -- UU UU"      ],
    "0x68acf134"      => ["0xU"        , "-- -- UU UU UU UU"],
    "0xacf134"        => ["0xW"        , "-- -- -- WW WW WW"],
    "0xf134"          => ["0xY"        , "-- -- -- -- YY YY"]
);

while (<>) {
    chop while substr($_, -1) le " ";
    ($bin, $mne, $opr) = split(/\t/);
    $opr =~ s/\(([^)]+),([^)]+)\)/($1;$2)/g;
    @oprs = ();
    foreach $o(split(",", $opr)) {
        $o =~ s/;/,/g;
        ($o1, $b1) = @{$opt{$o}};
        for ($j = 0; $j < length($b1); ++$j) {
            $ch = substr($b1, $j, 1);
            if ($ch ge "S") {
                $bin = substr($bin, 0, $j) . $ch . substr($bin, $j + 1);
            }
        }
        push(@oprs, $o1);
    }
    print "$bin\t$mne\t", join(",", @oprs), "\n";
}
